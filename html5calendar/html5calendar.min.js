/*!
 * HTML5Calendar v0.0.1-alpha1
 * Docs & License: https://github.com/scottpledger/html5calendar
 * (c) 2014 Scott Pledger
 */
(function(t){"function"==typeof define&&define.amd?define(["jquery","moment"],t):t(jQuery,moment)})(function(t,e){var n;n=function(n){function a(n,s){this.element=t(n),this.options=t.extend(!0,{},a.defaultOptions,s,a._getOptsFromElement(this.element)),this.element.addClass("html5calendar"),this._getOptsFromElement(),this.weekOffset=0,this.today=e(),this.defaultDate="today"==this.options.date?e():e(this.options.defaultDate),this.innerElement=this.element.find(".ht5c-inner"),0===this.innerElement.length&&(this.innerElement=t('<div class="ht5c-inner"></div>'),this.element.append(this.innerElement)),this.viewContainer=t('<div class="ht5c-view"></div>'),this.weeksList=t('<ul class="ht5c-weeks"></ul>'),this.hourRows=t('<ul class="ht5c-hours"><li></li></ul>'),this.days={},this.weeks={},this.colWidth=100/this.options.daysPerWeek,this.hourHeight=0,this.innerElement.append(this.hourRows),this.innerElement.append(this.viewContainer),this.viewContainer.append(this.weeksList),this.eventData=this.element.find("[data-calendar-events]"),this.today.startOf("day"),this._initButtons(),this._parseEvents(),this.innerElement.removeClass("agenda basic month").addClass(this.options.type),this.element.removeClass("ht5c-agenda ht5c-basic ht5c-month").addClass("ht5c-"+this.options.type),this.render(),this._mouseInit()}return a.prototype._setOption=function(){},a.prototype._initButtons=function(){var e=this;this.element.find("[data-calendar-action]").on("click",function(){var n=t(this);e.element.html5calendar(n.attr("data-calendar-action"))}),this.element.find("[data-calendar-option]").on("click",function(){var n=t(this);e.element.html5calendar("option",n.attr("data-calendar-option"),n.attr("data-calendar-optionValue"))})},a.prototype.render=function(){},a._getOptsFromElement=function(t){var e,s={};for(var i in a.defaultOptions)e=t.attr("data-calendar-"+i.toLowerCase()),e!==n&&(s[i]=e);return s},a.defaultOptions={defaultTimedEventDuration:"02:00:00",defaultAllDayEventDuration:{days:1},forceEventDuration:!1,nextDayThreshold:"05:00:00",view:"month",eventSources:["[data-calendar-events]"],weekends:!0,lazyFetching:!0,startParam:"start",endParam:"end",timezoneParam:"timezone",titleFormat:{month:"MMMM YYYY",week:"ll",day:"LL"},columnFormat:{month:"ddd",week:"ddd M/D",day:"dddd"},timeFormat:{"default":"h:mm a"},isRTL:!1,selectable:!1,unselectAuto:!0,dropAccept:"*",handleWindowResize:!0},a}();var a;a=function(){function n(a){var s,i,r;for(r in n.defaults)this[r]=n.defaults[r];if(t.isPlainObject(a)){for(r in a)"start"==r?s=a[r]:"end"==r?i=a[r]:this[r]=a[r];this.element=t("<li></li>")}else{if("object"!=t.type(t(a)[0]))throw Error("Invalid Event!");var o,l,h=t(a),d=h[0].attributes;if(h.data("event")&&null!=h.data("event"))return h.data("event");for(var r=0;d.length>r;r++)o=d[r],o.name.slice(0,n.attrPrefix.length)==n.attrPrefix&&(l=o.name.slice(n.attrPrefix.length),"start"==l?s=o.value:"end"==l?i=o.value:this[o.name.slice(n.attrPrefix.length)]=o.value);this.element=h,h.attr("draggable")?(h.attr("draggable",!1),this.movable=!0):this.movable=!1,h.attr("resizable")?(h.attr("resizable",!1),this.resizable=!0):this.resizable=!1}if(s=e(s),i=e(i),!s.isValid())throw Error("Invalid Event!");if(this.start=s,i.isValid()&&(this.end=i,this.end.isBefore(this.start)))throw Error("Invalid Event!");this.allDay&&(this.start.startOf("day"),this.end=e(s).endOf("day")),this.html&&this.element.html(this.html),this.resizable&&this.element.append('<hr class="ht5c-event-resizeHandle">'),this.element.addClass("ht5c-event"),this.element.data("event",this),this._segments=[]}return n.prototype=e.range(0,1),n.prototype.constructor=n,n.attrPrefix="data-calendar-event-",n.prototype._rmSegments=function(){t(this._segments).each(function(e,n){t(n).remove()}),this._segments=[]},n.prototype._getSegment=function(){var t=this.element.clone();return t.data("event",this),this._segments.push(t),t},n.prototype.makeSegments=function(n){this._rmSegments();var a,s,i,r,o,l,h=this.chunk("into"+n);this.element.find('[data-calendar-event-receive="timeSpan"]').html(this.format());for(a in h)s=h[a],o=s.start,l=s.end,i=this._getSegment(),r=o.diff(e(o).startOf("day"),"hours",!0),i.data("range",s),i.data("dimensions",{top:r,height:l.diff(o,"hours",!0)});return t(this._segments)},n.prototype.redraw=function(){this.element.find('[data-calendar-event-receive="timeSpan"]').html(this.format()),t(this._segments).find('[data-calendar-event-receive="timeSpan"]').html(this.format())},n.prototype.clone=function(){var t,e,a=this.element.clone();a.attr("data-calendar-event-start",this.start.format()),a.attr("data-calendar-event-end",this.end.format()),a.attr("data-calendar-event-allDay",this.allDay),t=new n(a);for(e in this._segments)t._segments.push(this._segments[e].clone());return t},n.prototype.show=function(){t(this._segments).each(function(e,n){t(n).css("display","block")})},n.prototype.hide=function(){t(this._segments).each(function(e,n){t(n).css("display","none")})},n.prototype.addClass=function(){return t.fn.addClass.apply(this.element,Array.prototype.slice.apply(arguments,[0])),t.fn.addClass.apply(t(this._segments),Array.prototype.slice.apply(arguments,[0])),this},n.prototype.removeClass=function(){return t.fn.removeClass.apply(this.element,Array.prototype.slice.apply(arguments,[0])),t.fn.removeClass.apply(t(this._segments),Array.prototype.slice.apply(arguments,[0])),this},n.prototype.add=function(){this.start.add(arguments[0],arguments[1]),this.end.add(arguments[0],arguments[1])},n.prototype.update=function(){},n.prototype.remove=function(){this.element.remove(),t(this._segments).each(function(e,n){t(n).remove()})},n.defaults={allDay:!1},n}(),t.fn.html5calendar=function(){console.log(this)},t('[data-calendar="html5"]').html5calendar()});